<!DOCTYPE html>
<html>
<head>
  <title>Agenda de Citas Médicas</title>
  <!-- Enlace al archivo CSS de Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .form-row {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      grid-gap: 1rem;
      margin-bottom: 1rem;
    }

    .form-row .form-group {
      grid-column: span 3;
    }

    .form-row .form-group .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
    }

    /* Modo Oscuro */
    body.dark-mode {
      background-color: #343a40;
      color: #fff;
    }

    body.dark-mode .form-control {
      background-color: #333;
      color: #fff;
    }

    body.dark-mode .table {
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="container mt-5">
    <h1 class="text-center mb-5">Agenda de Citas Médicas</h1>
    <div class="row">
      <form id="formulario" class="col-md-6">
        <div class="form-row">
          <div class="form-group">
            <label for="nombre" class="form-label">Nombre Paciente:</label>
            <input type="text" class="form-control" id="nombre" required>
          </div>
          <div class="form-group">
            <label for="edad" class="form-label">Edad:</label>
            <input type="number" class="form-control" id="edad" required>
          </div>

          <div class="form-group">
            <label for="genero" class="form-label">Género:</label>
            <select class="form-select" id="genero" required>
              <option value="">Seleccionar</option>
              <option value="masculino">Masculino</option>
              <option value="femenino">Femenino</option>
            </select>
          </div>
          <div class="form-group">
            <label for="numero" class="form-label">Número Telefónico:</label>
            <input type="number" class="form-control" id="numero" required>
          </div>
          <div class="form-group">
            <label for="eps" class="form-label">EPS:</label>
            <select class="form-select" id="eps" required>
              <option value="">Seleccionar</option>
              <option value="ALIANSALUD ENTIDAD PROMOTORA DE SALUD">ALIANSALUD ENTIDAD PROMOTORA DE SALUD</option>
              <option value="CONFAMILIAR">CONFAMILIAR</option>
              <option value="FAMISANAR">FAMISANAR</option>
              <option value="SANITAS">SANITAS</option>
              <option value="NUEVA EPS">NUEVA EPS</option>
              <option value="SURA">SURA</option>
              <option value="SALUD TOTAL">SALUD TOTAL</option>
              <option value="COOSALUD">COOSALUD</option>
              <option value="MEDIMAS">MEDIMAS</option>
              <option value="COMPENSAR">COMPENSAR</option>
              <option value="MALLAMAS">MALLAMAS</option>
              <option value="EPSI">EPSI</option>
              <option value="CAJA COPI">CAJA COPI</option>
            </select>
          </div>
          <div class="form-group">
            <label for="nombremedico" class="form-label">Nombre Médico:</label>
            <input type="text" class="form-control" id="nombremedico" required>
          </div>
          <div class="form-group">
            <label for="especialidad" class="form-label">Especialidad:</label>
            <select class="form-select" id="especialidad" required>
              <option value="">Seleccionar</option>
              <option value="Medicina general">Medicina general</option>
              <option value="Pediatría">Pediatría</option>
              <option value="Ginecología">Ginecología</option>
              <option value="Obstetricia">Obstetricia</option>
              <option value="Cardiología">Cardiología</option>
              <option value="Dermatología">Dermatología</option>
              <option value="Oftalmología">Oftalmología</option>
              <option value="Otorrinolaringología">Otorrinolaringología</option>
              <option value="Ortopedia">Ortopedia</option>
              <option value="Psiquiatría">Psiquiatría</option>
              <option value="Endocrinología">Endocrinología</option>
              <option value="Gastroenterología">Gastroenterología</option>
              <option value="Nefrología">Nefrología</option>
              <option value="Urología">Urología</option>
            </select>
          </div>
          <div class="form-group">
            <label for="lugar" class="form-label">Lugar de Consulta:</label>
            <select class="form-select" id="lugar" required>
              <option value="">Seleccionar</option>
              <option value="Hospital">Hospital</option>
              <option value="Clínica">Clínica</option>
              <option value="Hogar">Residencia del Paciente</option>
            </select>
          </div>
          <div class="form-group">
            <label for="direccion" class="form-label">Dirección Cita:</label>
            <input type="text" class="form-control" id="direccion" required>
          </div>
          <div class="form-group">
            <label for="consultorio" class="form-label">Número de Consultorio:</label>
            <input type="text" class="form-control" id="consultorio" required>
          </div>
          <div class="form-group">
            <label for="fecha" class="form-label">Fecha cita:</label>
            <input type="date" class="form-control" id="fecha" required>
          </div>
          <div class="form-group">
            <label for="hora" class="form-label">Hora cita:</label>
            <input type="time" class="form-control" id="hora" required>
          </div>
          <div class="form-group text-end">
            <button type="submit" class="btn btn-primary">Agendar Cita</button>
          </div>
        </div>
      </form>

      <div class="col-md-6">
        <div class="mb-3">
          <h2 class="text-center">Citas Agendadas</h2>
        </div>
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Nombre Paciente</th>
              <th>Especialidad</th>
              <th>Lugar Consulta</th>
              <th>Dirección Cita</th>
              <th>Consultorio</th>
              <th>Fecha</th>
              <th>Hora</th>
              <th>Médico</th>
            </tr>
          </thead>
          <tbody id="tablaCitas">
            <!-- Aquí se mostrarán los registros -->
          </tbody>
        </table>
        <div class="d-grid">
          <button id="exportarExcel" class="btn btn-warning">Exportar a Excel</button>
          <button id="enviarCita" class="btn btn-success mt-2">Enviar Cita por WhatsApp</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Interruptor (Switch) para Modo Oscuro -->
  <div class="form-check form-switch position-fixed top-0 end-0 m-3">
    <input class="form-check-input" type="checkbox" id="switchDarkMode">
    <label class="form-check-label" for="switchDarkMode">Modo Oscuro</label>
  </div>

  <!-- Enlace al archivo JavaScript de Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    var registros = [];

    function mostrarRegistros() {
      var tabla = document.getElementById("tablaCitas");

      // Limpiar la tabla
      tabla.innerHTML = "";

      // Agregar las filas de los registros
      for (var i = 0; i < registros.length; i++) {
        var cita = registros[i];

        var fila = document.createElement("tr");
        for (var j = 0; j < cita.length; j++) {
          var celda = document.createElement("td");
          celda.innerText = cita[j];
          fila.appendChild(celda);
        }

        tabla.appendChild(fila);
      }
    }

    function exportarExcel() {
      var wb = XLSX.utils.book_new();
      var ws = XLSX.utils.aoa_to_sheet(registros);
      XLSX.utils.book_append_sheet(wb, ws, "Citas");

      XLSX.writeFile(wb, "citas.xlsx");
    }

    function enviarCitaWhatsApp() {
      if (registros.length === 0) {
        alert("No hay citas agendadas.");
        return;
      }

      var cita = registros[registros.length - 1];
      var nombre = cita[0];
      var fecha = cita[5];
      var hora = cita[6];
      var lugar = cita[2];
      var consultorio = cita[3];
      var medico = cita[7];

      var mensaje = "¡Hola " + nombre + "! Tu cita está agendada para el " + fecha + " a las " + hora + " en " + lugar + ", consultorio " + consultorio + ". Atentamente el Dr. " + medico + ".";

      var urlWhatsApp = "https://wa.me/?text=" + encodeURIComponent(mensaje);
      window.open(urlWhatsApp);
    }

    function toggleDarkMode() {
      var body = document.body;
      body.classList.toggle("dark-mode");
    }

    var formulario = document.getElementById("formulario");
    formulario.addEventListener("submit", function(event) {
      event.preventDefault(); // Evitar envío del formulario

      // Obtener los datos del formulario
      var nombre = document.getElementById("nombre").value;
      var edad = document.getElementById("edad").value;
      var genero = document.getElementById("genero").value;
      var eps = document.getElementById("eps").value;
      var nombremedico = document.getElementById("nombremedico").value;
      var especialidad = document.getElementById("especialidad").value;
      var lugar = document.getElementById("lugar").value;
      var direccion = document.getElementById("direccion").value;
      var consultorio = document.getElementById("consultorio").value;
      var fecha = document.getElementById("fecha").value;
      var hora = document.getElementById("hora").value;

      // Agregar los datos a los registros
      registros.push([nombre, especialidad, lugar, direccion, consultorio, fecha, hora, nombremedico]);

      // Limpiar los campos del formulario
      formulario.reset();

      // Actualizar la tabla con los nuevos registros
      mostrarRegistros();
    });

    var exportarExcelButton = document.getElementById("exportarExcel");
    exportarExcelButton.addEventListener("click", exportarExcel);

    var enviarCitaButton = document.getElementById("enviarCita");
    enviarCitaButton.addEventListener("click", enviarCitaWhatsApp);

    var switchButton = document.getElementById("switchDarkMode");
    switchButton.addEventListener("change", toggleDarkMode);
  </script>
</body>
</html>
